Homework 3
================
Minjie Bao
2020-10-10

### Problem 1

``` r
data("instacart")
```

This dataset contains 1384617 rows and 15 columns.

Observations are the level of items in orders by user. There are user/
order variables – user ID, order ID, order day, and order hour. There
are also item variables – name, aisle, department, and some nueric
codes.

How many aisles, and which are most items from?

``` r
instacart %>% 
  count(aisle) %>% 
  arrange(desc(n))
```

    ## # A tibble: 134 x 2
    ##    aisle                              n
    ##    <chr>                          <int>
    ##  1 fresh vegetables              150609
    ##  2 fresh fruits                  150473
    ##  3 packaged vegetables fruits     78493
    ##  4 yogurt                         55240
    ##  5 packaged cheese                41699
    ##  6 water seltzer sparkling water  36617
    ##  7 milk                           32644
    ##  8 chips pretzels                 31269
    ##  9 soy lactosefree                26240
    ## 10 bread                          23635
    ## # … with 124 more rows

Let’s make a plot

``` r
instacart %>% 
  count(aisle) %>% 
  filter(n>10000) %>% 
  mutate(
    aisle = factor(aisle),
    aisle = fct_reorder(aisle,n)
  ) %>% 
  ggplot(aes(x=aisle, y=n)) +
  geom_point() +
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1))
```

<img src="p8105_hw3_mb4757_files/figure-gfm/unnamed-chunk-3-1.png" width="90%" />

Let’s make a table\!\!

``` r
instacart %>% 
  filter(aisle %in% c("baking ingredients", "dog food care", "packaged vegetables fruits")) %>% 
  group_by(aisle) %>% 
  count(product_name) %>% 
  mutate(rank = min_rank(desc(n))) %>% 
  filter(rank < 4) %>% 
  arrange(aisle, rank) %>% 
  knitr::kable()
```

| aisle                      | product\_name                                 |    n | rank |
| :------------------------- | :-------------------------------------------- | ---: | ---: |
| baking ingredients         | Light Brown Sugar                             |  499 |    1 |
| baking ingredients         | Pure Baking Soda                              |  387 |    2 |
| baking ingredients         | Cane Sugar                                    |  336 |    3 |
| dog food care              | Snack Sticks Chicken & Rice Recipe Dog Treats |   30 |    1 |
| dog food care              | Organix Chicken & Brown Rice Recipe           |   28 |    2 |
| dog food care              | Small Dog Biscuits                            |   26 |    3 |
| packaged vegetables fruits | Organic Baby Spinach                          | 9784 |    1 |
| packaged vegetables fruits | Organic Raspberries                           | 5546 |    2 |
| packaged vegetables fruits | Organic Blueberries                           | 4966 |    3 |

Apples vs ice cream..

``` r
instacart %>% 
  filter(product_name %in% c("Pink Lady Apples", "Coffee Ice Cream")) %>% 
  group_by(product_name, order_dow) %>% 
  summarize(mean_hour = mean(order_hour_of_day)) %>% 
  pivot_wider(
    names_from = order_dow,
    values_from = mean_hour
  )
```

    ## `summarise()` regrouping output by 'product_name' (override with `.groups` argument)

    ## # A tibble: 2 x 8
    ## # Groups:   product_name [2]
    ##   product_name       `0`   `1`   `2`   `3`   `4`   `5`   `6`
    ##   <chr>            <dbl> <dbl> <dbl> <dbl> <dbl> <dbl> <dbl>
    ## 1 Coffee Ice Cream  13.8  14.3  15.4  15.3  15.2  12.3  13.8
    ## 2 Pink Lady Apples  13.4  11.4  11.7  14.2  11.6  12.8  11.9

### Problem 2

``` r
accel_df =
read_csv("./data/accel_data.csv") %>% 
pivot_longer(
  activity.1 : activity.1440,
    names_to = "activity",
    values_to = "minutes"
) %>% 
mutate(
  weekday=case_when(
day %in% c("Monday","Tuesday","Wednesday","Thursday","Friday") ~ "weekday",
day %in% c("Saturday","Sunday") ~ "weekend"
),
day = factor(day),
day = forcats::fct_relevel(day, c("Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday")),
weekday = as.factor(weekday) 
)
```

    ## Parsed with column specification:
    ## cols(
    ##   .default = col_double(),
    ##   day = col_character()
    ## )

    ## See spec(...) for full column specifications.

``` r
head(accel_df)
```

    ## # A tibble: 6 x 6
    ##    week day_id day    activity   minutes weekday
    ##   <dbl>  <dbl> <fct>  <chr>        <dbl> <fct>  
    ## 1     1      1 Friday activity.1    88.4 weekday
    ## 2     1      1 Friday activity.2    82.2 weekday
    ## 3     1      1 Friday activity.3    64.4 weekday
    ## 4     1      1 Friday activity.4    70.0 weekday
    ## 5     1      1 Friday activity.5    75.0 weekday
    ## 6     1      1 Friday activity.6    66.3 weekday

``` r
count(accel_df)
```

    ## # A tibble: 1 x 1
    ##       n
    ##   <int>
    ## 1 50400

There are 6 variables in the cleaned dataset: week, day\_id, day,
activity, minutes, weekday. This dataset contains 50400 rows and 6
columns. There are 50400 observations. The variables “week”, “day\_id”
and “minutes”are double datat ype. “day” and “weekday” are factor datat
ype. “activity” is character data ype.

``` r
accel_df %>% 
group_by(week, day, weekday) %>% 
  summarize(total_activity = sum(minutes)) %>% 
    knitr::kable(digits = 1)
```

    ## `summarise()` regrouping output by 'week', 'day' (override with `.groups` argument)

| week | day       | weekday | total\_activity |
| ---: | :-------- | :------ | --------------: |
|    1 | Monday    | weekday |         78828.1 |
|    1 | Tuesday   | weekday |        307094.2 |
|    1 | Wednesday | weekday |        340115.0 |
|    1 | Thursday  | weekday |        355923.6 |
|    1 | Friday    | weekday |        480542.6 |
|    1 | Saturday  | weekend |        376254.0 |
|    1 | Sunday    | weekend |        631105.0 |
|    2 | Monday    | weekday |        295431.0 |
|    2 | Tuesday   | weekday |        423245.0 |
|    2 | Wednesday | weekday |        440962.0 |
|    2 | Thursday  | weekday |        474048.0 |
|    2 | Friday    | weekday |        568839.0 |
|    2 | Saturday  | weekend |        607175.0 |
|    2 | Sunday    | weekend |        422018.0 |
|    3 | Monday    | weekday |        685910.0 |
|    3 | Tuesday   | weekday |        381507.0 |
|    3 | Wednesday | weekday |        468869.0 |
|    3 | Thursday  | weekday |        371230.0 |
|    3 | Friday    | weekday |        467420.0 |
|    3 | Saturday  | weekend |        382928.0 |
|    3 | Sunday    | weekend |        467052.0 |
|    4 | Monday    | weekday |        409450.0 |
|    4 | Tuesday   | weekday |        319568.0 |
|    4 | Wednesday | weekday |        434460.0 |
|    4 | Thursday  | weekday |        340291.0 |
|    4 | Friday    | weekday |        154049.0 |
|    4 | Saturday  | weekend |          1440.0 |
|    4 | Sunday    | weekend |        260617.0 |
|    5 | Monday    | weekday |        389080.0 |
|    5 | Tuesday   | weekday |        367824.0 |
|    5 | Wednesday | weekday |        445366.0 |
|    5 | Thursday  | weekday |        549658.0 |
|    5 | Friday    | weekday |        620860.0 |
|    5 | Saturday  | weekend |          1440.0 |
|    5 | Sunday    | weekend |        138421.0 |

For week 1, the 63 year-old male has the least activity on Monday, and
has the most activity on Sunday.

For week 2, the 63 year-old male has the least activity on Monday, and
has the most activity on Saturday.

For week 3, the 63 year-old male has the least activity on Thursday, and
has the most activity on Monday.

For week 4, the 63 year-old male has the least activity on Saturday, and
has the most activity on Wednesday.

For week 5, the 63 year-old male has the least activity on Saturday, and
has the most activity on Friday.

### Problem 3
